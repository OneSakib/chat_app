{% extends 'base.html' %}
{% load static %} 
{% block style %}
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/material-design-icons/3.0.1/iconfont/material-icons.min.css"
/>
<link rel="stylesheet" href="{% static 'css/chatstyle.css' %}" />
<style>
  .chat-section{
    height: 80vh !important;
    overflow: auto;
  }
  .chat-header{
    position: sticky;
    top: 0;
    left: 0;
    z-index: 99;
  }
  .chat-search{
    position: sticky;
    top: 70px;
    left: 0;
    z-index: 99;
  }
  .chat-input{
    position: sticky;
    bottom: 0;
    left: 0;
  }
</style>  
{% endblock %}
 {% block content %}
<div class="row no-gutters">
  <div class="col-md-4 border-right chat-section">
    <div class="settings-tray chat-header">
      <img
        class="profile-image"
        src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/filip.jpg"
        alt="Profile img"
      />
      <span class="settings-tray--right">
        <i class="material-icons">cached</i>
        <i class="material-icons">message</i>
        <i class="material-icons">menu</i>
      </span>
    </div>
    <div class="search-box chat-search">
      <div class="input-wrapper">
        <i class="material-icons">search</i>
        <input placeholder="Search here" type="text" />
      </div>
    </div>
    <div class="friend-drawer friend-drawer--onhover">
      <img
        class="profile-image"
        src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg"
        alt=""
      />
      <div class="text">
        <h6>Robo Cop</h6>
        <p class="text-muted">Hey, you're arrested!</p>
      </div>
      <span class="time text-muted small">13:21</span>
    </div>
    <hr />
    <div class="friend-drawer friend-drawer--onhover">
      <img
        class="profile-image"
        src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/optimus-prime.jpeg"
        alt=""
      />
      <div class="text">
        <h6>Optimus</h6>
        <p class="text-muted">Wanna grab a beer?</p>
      </div>
      <span class="time text-muted small">00:32</span>
    </div>
    <hr />
    <div class="friend-drawer friend-drawer--onhover">
      <img
        class="profile-image"
        src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/real-terminator.png"
        alt=""
      />
      <div class="text">
        <h6>Skynet</h6>
        <p class="text-muted">Seen that canned piece of s?</p>
      </div>
      <span class="time text-muted small">13:21</span>
    </div>
    <hr />
    <div class="friend-drawer friend-drawer--onhover">
      <img
        class="profile-image"
        src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/termy.jpg"
        alt=""
      />
      <div class="text">
        <h6>Termy</h6>
        <p class="text-muted">Im studying spanish...</p>
      </div>
      <span class="time text-muted small">13:21</span>
    </div>
    <hr />
    <div class="friend-drawer friend-drawer--onhover">
      <img
        class="profile-image"
        src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/rick.jpg"
        alt=""
      />
      <div class="text">
        <h6>Richard</h6>
        <p class="text-muted">I'm not sure...</p>
      </div>
      <span class="time text-muted small">13:21</span>
    </div>
    <hr />
    <div class="friend-drawer friend-drawer--onhover">
      <img
        class="profile-image"
        src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/rachel.jpeg"
        alt=""
      />
      <div class="text">
        <h6>XXXXX</h6>
        <p class="text-muted">Hi, wanna see something?</p>
      </div>
      <span class="time text-muted small">13:21</span>
    </div>
  </div>
  <div class="col-md-8 chat-section">
    <div class="settings-tray chat-header">
      <div class="friend-drawer no-gutters friend-drawer--grey">
        <img
          class="profile-image"
          src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg"
          alt=""
        />
        <div class="text">
          <h6>Robo Cop</h6>
          <p class="text-muted">
            Layin' down the law since like before Christ...
          </p>
        </div>
        <span class="settings-tray--right">
          <i class="material-icons">cached</i>
          <i class="material-icons">message</i>
          <i class="material-icons">menu</i>
        </span>
      </div>
    </div>
    <div class="chat-panel">
      <div class="row no-gutters">
        <div class="col-md-3">
          <div class="chat-bubble chat-bubble--left">Hello dude!</div>
        </div>
      </div>
      <div class="row no-gutters">
        <div class="col-md-3 offset-md-9">
          <div class="chat-bubble chat-bubble--right">Hello dude!</div>
        </div>
      </div>
      <div class="row no-gutters">
        <div class="col-md-3 offset-md-9">
          <div class="chat-bubble chat-bubble--right">Hello dude!</div>
        </div>
      </div>
      <div class="row no-gutters">
        <div class="col-md-3">
          <div class="chat-bubble chat-bubble--left">Hello dude!</div>
        </div>
      </div>
      <div class="row no-gutters">
        <div class="col-md-3">
          <div class="chat-bubble chat-bubble--left">Hello dude!</div>
        </div>
      </div>
      <div class="row no-gutters">
        <div class="col-md-3">
          <div class="chat-bubble chat-bubble--left">Hello dude!</div>
        </div>
      </div>
      <div class="row no-gutters">
        <div class="col-md-3 offset-md-9">
          <div class="chat-bubble chat-bubble--right">Hello dude!</div>
        </div>
      </div>
      <div class="row chat-input">
        <div class="col-12">
          <div class="chat-box-tray">
            <i class="material-icons">sentiment_very_satisfied</i>
            <input type="text" placeholder="Type your message here..." />
            <i class="material-icons">mic</i>
            <i class="material-icons">send</i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="{% static 'js/chatjs.js' %}"></script>
<script>
  const room_id={{room_id}};
  const path='ws://'+window.location.host + '/ws/chat/'+  room_id  +'/'  ;
  const webSocket=new WebSocket(path)
  webSocket.onmessage=(e)=>{
    const data=JSON.parse(e.data);
    console.log("CALLED",data['message']);
  }
  webSocket.onopen=(e)=>{
    console.log("You are connected to WebSocket Successfully!")
    // webSocket.close() for close the websocket 
    webSocket.send(
      JSON.stringify({
        "message":"Hello, How are you?"
      })
    )
  }
  webSocket.onclose=(e)=>{
    console.error('Chat socket closed unexpectedly');
  }
  webSocket.error=(e)=>{
    console.error('Error:'+e);
  }
</script>
{% endblock %}